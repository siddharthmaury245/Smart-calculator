<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smart Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="description" content="Professional Smart Calculator powered by NEXACORE. Includes EMI, Bill, and Unit Converter.">
  <style>
    /* --- CSS VARIABLES --- */
    :root {
      --bg: #f4f6f9;
      --fg: #1a1a1a;
      --surface: #ffffff;
      --btn-bg: #eef2f5;
      --btn-shadow-dark: #d1d9e6;
      --btn-shadow-light: #ffffff;
      --accent: #ff6600;
      --accent-text: #fff;
    }
    body.dark {
      --bg: #121212;
      --fg: #e0e0e0;
      --surface: #1e1e1e;
      --btn-bg: #2d2d2d;
      --btn-shadow-dark: #000000;
      --btn-shadow-light: #333333;
      --accent: #00a8ff;
      --accent-text: #000;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
    
    body {
      margin: 0; padding: 0;
      font-family: sans-serif;
      background: var(--bg); color: var(--fg);
      /* Fix for mobile address bar hiding content */
      height: 100vh; 
      height: 100dvh; 
      display: flex; flex-direction: column;
      overflow: hidden;
    }

    /* --- DESKTOP FRAME --- */
    @media (min-width: 700px) {
      body {
        max-width: 400px;
        height: 85vh;
        max-height: 850px;
        margin: 5vh auto;
        border: 1px solid #ccc;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        position: relative;
        background: var(--bg);
      }
      html { background: #e0e0e0; height: 100%; display: flex; align-items: center; justify-content: center; }
    }

    /* --- NAVIGATION --- */
    .nav-bar {
      display: flex; background: var(--surface);
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      z-index: 50; padding: 5px; flex-shrink: 0;
    }
    .nav-item {
      flex: 1; text-align: center; padding: 10px;
      font-size: 14px; font-weight: bold; color: var(--fg); opacity: 0.6;
      cursor: pointer; border-radius: 8px; transition: 0.2s;
    }
    .nav-item.active {
      background: var(--accent); color: var(--accent-text); opacity: 1;
    }

    /* --- APP CONTAINER --- */
    .app-container {
      flex: 1; position: relative; overflow: hidden;
      display: flex; flex-direction: column;
      min-height: 0;
    }
    .page {
      display: none; height: 100%; width: 100%;
      flex-direction: column;
      padding: 15px; 
      overflow-y: hidden;
    }
    .page.active { display: flex; }
    .page.scrollable { overflow-y: auto; padding-bottom: 20px; }

    /* --- CALCULATOR UI --- */
    .top-toolbar {
      display: flex; justify-content: space-between; margin-bottom: 10px; flex-shrink: 0;
    }
    .icon-btn {
      background: var(--btn-bg); border: none; padding: 8px 12px;
      border-radius: 8px; font-size: 11px; font-weight: bold; cursor: pointer; color: var(--fg);
      box-shadow: 3px 3px 6px var(--btn-shadow-dark), -3px -3px 6px var(--btn-shadow-light);
    }
    .icon-btn:active { box-shadow: inset 2px 2px 5px var(--btn-shadow-dark); }

    .display-screen {
      width: 100%; background: var(--surface);
      padding: 20px; border-radius: 15px; text-align: right;
      font-size: 40px; border: none; color: var(--fg);
      box-shadow: inset 3px 3px 6px var(--btn-shadow-dark), inset -3px -3px 6px var(--btn-shadow-light);
      margin-bottom: 15px; flex-shrink: 0; height: 80px;
    }

    .keypad {
      display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;
      flex: 1; margin-bottom: 5px; min-height: 0;
    }

    .key {
      border: none; border-radius: 12px; background: var(--btn-bg);
      color: var(--fg); font-size: 20px; font-weight: 500; cursor: pointer;
      box-shadow: 4px 4px 8px var(--btn-shadow-dark), -4px -4px 8px var(--btn-shadow-light);
      display: flex; align-items: center; justify-content: center;
      transition: all 0.1s;
    }
    .key:active { transform: scale(0.95); box-shadow: inset 3px 3px 6px var(--btn-shadow-dark); }
    .key.accent { background: var(--accent); color: var(--accent-text); }
    .key.action { color: var(--accent); font-weight: bold; font-size: 18px; }

    /* --- AD SPACE --- */
    .ad-wrapper {
      flex-shrink: 0; margin-top: auto; width: 100%; height: 50px;
      display: none; animation: popUp 0.6s ease-out;
      border-top: 1px solid rgba(0,0,0,0.05);
    }
    .ad-placeholder {
      width: 100%; height: 100%; background: var(--surface);
      display: flex; align-items: center; justify-content: center;
      color: var(--fg); font-size: 10px; opacity: 0.8;
    }
    @keyframes popUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    /* --- INPUTS --- */
    .input-group { margin-bottom: 15px; }
    label { display: block; font-size: 12px; font-weight: bold; margin-bottom: 5px; opacity: 0.7; }
    input, select {
      width: 100%; padding: 14px; border-radius: 10px; border: none;
      background: var(--surface); color: var(--fg); font-size: 16px;
      box-shadow: inset 2px 2px 5px var(--btn-shadow-dark), inset -2px -2px 5px var(--btn-shadow-light);
    }

    /* --- FOOTER (ALL LINKS RESTORED) --- */
    .nexacore-footer {
      background: var(--surface); padding: 10px;
      text-align: center; font-size: 10px; border-top: 1px solid rgba(0,0,0,0.1);
      color: var(--fg); 
      flex-shrink: 0;
      display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 5px;
      padding-bottom: max(10px, env(safe-area-inset-bottom));
    }
    .footer-links {
      display: flex; gap: 15px; opacity: 0.8;
    }
    .footer-links span {
      cursor: pointer; text-decoration: underline;
    }
    
    /* --- MODALS & HISTORY --- */
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 200; align-items: center; justify-content: center; backdrop-filter: blur(3px); }
    .modal-box { background: var(--surface); padding: 20px; border-radius: 15px; width: 85%; max-width: 350px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); max-height: 80vh; overflow-y: auto; }
    .modal-box h3 { margin-top: 0; color: var(--accent); }
    .modal-box p { font-size: 13px; line-height: 1.4; opacity: 0.8; }
    
    .history-panel {
      position: fixed; bottom: 0; left: 0; width: 100%; height: 60%;
      background: var(--surface); border-top-left-radius: 20px; border-top-right-radius: 20px;
      box-shadow: 0 -5px 20px rgba(0,0,0,0.2); z-index: 100;
      transform: translateY(110%); transition: 0.3s; display: flex; flex-direction: column; padding: 20px;
    }
    .history-panel.open { transform: translateY(0); }
    .history-list { flex: 1; overflow-y: auto; margin-top: 10px; }
    .history-item { padding: 10px; border-bottom: 1px solid rgba(0,0,0,0.1); font-size: 16px; display: flex; justify-content: space-between; }
    
    /* Cookie Banner */
    .cookie-banner { position: fixed; bottom: 80px; left: 5%; width: 90%; background: #333; color: #fff; padding: 15px; border-radius: 10px; z-index: 300; display: none; text-align: center; font-size: 12px; }
    .cookie-btn { background: var(--accent); border: none; color: white; padding: 5px 15px; border-radius: 5px; margin-top: 10px; cursor: pointer; }

  </style>
</head>
<body onload="initApp()">

  <div class="nav-bar">
    <div class="nav-item active" onclick="switchPage('calc')">Calc</div>
    <div class="nav-item" onclick="switchPage('conv')">Convert</div>
    <div class="nav-item" onclick="switchPage('emi')">EMI</div>
    <div class="nav-item" onclick="switchPage('bill')">Bill</div>
  </div>

  <div class="app-container">
    
    <div id="calc" class="page active">
      <div class="top-toolbar">
        <button class="icon-btn" onclick="toggleHistoryPanel()">HISTORY</button>
        <button class="icon-btn" onclick="toggleTheme()">THEME</button>
      </div>
      <input type="text" id="display" class="display-screen" readonly placeholder="0">
      <div class="keypad">
        <button class="key action" onclick="clearDisplay()">AC</button>
        <button class="key action" onclick="delChar()">DEL</button>
        <button class="key action" onclick="append('%')">%</button>
        <button class="key action" onclick="append('/')">&divide;</button>

        <button class="key" onclick="append('7')">7</button>
        <button class="key" onclick="append('8')">8</button>
        <button class="key" onclick="append('9')">9</button>
        <button class="key action" onclick="append('*')">&times;</button>

        <button class="key" onclick="append('4')">4</button>
        <button class="key" onclick="append('5')">5</button>
        <button class="key" onclick="append('6')">6</button>
        <button class="key action" onclick="append('-')">&minus;</button>

        <button class="key" onclick="append('1')">1</button>
        <button class="key" onclick="append('2')">2</button>
        <button class="key" onclick="append('3')">3</button>
        <button class="key action" onclick="append('+')">+</button>

        <button class="key" onclick="append('0')" style="grid-column: span 2">0</button>
        <button class="key" onclick="append('.')">.</button>
        <button class="key accent" onclick="calculate()">=</button>
      </div>
      
      <div class="ad-wrapper" id="ad-calc">
         <div class="ad-placeholder">Welcome to NEXACORE</div>
      </div>
    </div>

    <div id="conv" class="page scrollable">
      <h2 style="text-align:center; margin:10px;">Unit Converter</h2>
      <div class="input-group">
        <label>Type</label>
        <select id="convType" onchange="populateUnits()">
          <option value="length">Length</option>
          <option value="mass">Mass</option>
          <option value="temp">Temperature</option>
          <option value="data">Data</option>
        </select>
      </div>
      <div class="input-group"><input type="number" id="convInput" placeholder="Enter Value" oninput="doConvert()"></div>
      <div style="display:flex; gap:10px;">
        <div style="flex:1"><label>From</label><select id="convFrom" onchange="doConvert()"></select></div>
        <div style="flex:1"><label>To</label><select id="convTo" onchange="doConvert()"></select></div>
      </div>
      <div class="input-group" style="margin-top:15px;">
        <label>Result</label>
        <input type="text" id="convResult" readonly style="font-weight:bold; color:var(--accent);">
      </div>
      <div class="ad-wrapper" id="ad-conv"><div class="ad-placeholder">NEXACORE Tools</div></div>
    </div>

    <div id="emi" class="page scrollable">
      <h2 style="text-align:center; margin:10px;">EMI Planner</h2>
      <div class="input-group"><label>Loan Amount</label><input type="number" id="emiP"></div>
      <div class="input-group"><label>Interest Rate (%)</label><input type="number" id="emiR"></div>
      <div class="input-group"><label>Years</label><input type="number" id="emiN"></div>
      <button class="key accent" style="width:100%; padding:15px; margin-top:10px;" onclick="calculateEMI()">Calculate</button>
      <div style="margin-top:20px; text-align:center;">
        <div style="font-size:12px;">Monthly Payment</div>
        <div id="emiResult" style="font-size:24px; font-weight:bold; color:var(--accent);">&#8377; 0.00</div>
      </div>
      <div class="ad-wrapper" id="ad-emi"><div class="ad-placeholder">Smart Finance</div></div>
    </div>

    <div id="bill" class="page scrollable">
      <h2 style="text-align:center; margin:10px;">Bill Estimator</h2>
      <div class="input-group">
        <label>Region</label>
        <select id="billRegion" onchange="updateBillCats()"><option value="India">India</option><option value="USA">USA</option><option value="UK">UK</option></select>
      </div>
      <div class="input-group"><label>Category</label><select id="billCat" onchange="updateBillRate()"></select></div>
      <div class="input-group">
        <div style="display:flex; gap:10px;">
           <div style="flex:1"><label>Units</label><input type="number" id="billUnits"></div>
           <div style="flex:1"><label>Rate</label><input type="number" id="billRate"></div>
        </div>
      </div>
      <button class="key accent" style="width:100%; padding:15px;" onclick="calculateBill()">Calculate</button>
      <div id="billTotal" style="margin-top:20px; text-align:center; font-weight:bold; font-size:20px;">Total: 0.00</div>
      <div class="ad-wrapper" id="ad-bill"><div class="ad-placeholder">Save Energy</div></div>
    </div>

  </div>

  <div class="nexacore-footer">
    <div style="margin-bottom:5px;">Powered by <b>NEXACORE</b></div>
    <div class="footer-links">
      <span onclick="openModal('privacy')">Privacy</span>
      <span onclick="openModal('terms')">Terms</span>
      <span onclick="openModal('about')">About</span>
      <span onclick="openModal('contact')">Contact</span>
    </div>
  </div>

  <div id="cookieBanner" class="cookie-banner">
    <p>We use cookies to ensure you get the best experience.</p>
    <button class="cookie-btn" onclick="acceptCookies()">Accept</button>
  </div>

  <div id="historyPanel" class="history-panel">
    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
      <h3>History</h3>
      <button onclick="clearHistory()" style="background:red; color:white; border:none; padding:5px 10px; border-radius:5px;">Clear</button>
    </div>
    <div id="historyList" class="history-list"></div>
    <button onclick="toggleHistoryPanel()" style="padding:10px; margin-top:10px; background:var(--btn-bg); border:none; border-radius:10px; color:var(--fg);">Close</button>
  </div>

  <div id="modal-privacy" class="modal-overlay" onclick="closeModal('privacy')">
    <div class="modal-box" onclick="event.stopPropagation()">
      <h3>Privacy Policy</h3>
      <p>Data is stored locally on your device. We do not track personal info. Third-party vendors (Google) may use cookies to serve ads based on your visit.</p>
      <button onclick="closeModal('privacy')" style="width:100%; padding:10px; background:var(--accent); border:none; color:white; border-radius:8px; margin-top:10px;">Close</button>
    </div>
  </div>

  <div id="modal-terms" class="modal-overlay" onclick="closeModal('terms')">
    <div class="modal-box" onclick="event.stopPropagation()">
      <h3>Terms of Use</h3>
      <p>This tool is provided "as is". NEXACORE is not liable for calculation errors. By using this site, you agree to these terms.</p>
      <button onclick="closeModal('terms')" style="width:100%; padding:10px; background:var(--accent); border:none; color:white; border-radius:8px; margin-top:10px;">Accept</button>
    </div>
  </div>

  <div id="modal-about" class="modal-overlay" onclick="closeModal('about')">
    <div class="modal-box" onclick="event.stopPropagation()">
      <h3>About NEXACORE</h3>
      <p>NEXACORE builds high-speed digital utilities for everyday math, finance, and conversion needs.</p>
      <button onclick="closeModal('about')" style="width:100%; padding:10px; background:var(--accent); border:none; color:white; border-radius:8px; margin-top:10px;">Close</button>
    </div>
  </div>

  <div id="modal-contact" class="modal-overlay" onclick="closeModal('contact')">
    <div class="modal-box" onclick="event.stopPropagation()">
      <h3>Contact Us</h3>
      <p>Have feedback or questions?</p>
      <p><strong>Email:</strong> support@nexacore.com</p>
      <p><strong>Address:</strong> NEXACORE Digital, India.</p>
      <button onclick="closeModal('contact')" style="width:100%; padding:10px; background:var(--accent); border:none; color:white; border-radius:8px; margin-top:10px;">Close</button>
    </div>
  </div>

  <script>
    function initApp() {
      if(localStorage.getItem('theme')==='dark') document.body.classList.add('dark');
      if(!localStorage.getItem('cookiesAccepted')) setTimeout(()=>document.getElementById('cookieBanner').style.display='block', 2000);
      populateUnits(); updateBillCats(); triggerAds('calc');
    }
    function acceptCookies(){ localStorage.setItem('cookiesAccepted','true'); document.getElementById('cookieBanner').style.display='none'; }
    
    function switchPage(id) {
      document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
      document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelector(`.nav-item[onclick="switchPage('${id}')"]`).classList.add('active');
      triggerAds(id);
    }

    function toggleTheme(){ let d=document.body.classList.toggle('dark'); localStorage.setItem('theme', d?'dark':'light'); }

    /* --- CALCULATOR --- */
    function append(v){ document.getElementById('display').value += v; }
    function clearDisplay(){ document.getElementById('display').value = ''; }
    function delChar(){ let d=document.getElementById('display'); d.value=d.value.slice(0,-1); }
    function calculate(){
       try{ 
         let v=document.getElementById('display').value; 
         if(!v)return;
         let r=eval(v.replace(/×/g,'*').replace(/÷/g,'/')); 
         saveHistory(v,r); 
         document.getElementById('display').value=r; 
       } catch{
         document.getElementById('display').value='Error';
       }
    }

    /* --- HISTORY --- */
    function saveHistory(e,r){
       let h=JSON.parse(localStorage.getItem('ch')||'[]'); h.unshift({e,r}); if(h.length>20)h.pop();
       localStorage.setItem('ch',JSON.stringify(h));
    }
    function renderHistory(){
       let l=document.getElementById('historyList'); l.innerHTML='';
       let h=JSON.parse(localStorage.getItem('ch')||'[]');
       if(!h.length) l.innerHTML='<div style="text-align:center; opacity:0.5; padding:20px;">No History</div>';
       h.forEach(i=>{
         let d=document.createElement('div'); d.className='history-item';
         d.innerHTML=`<span>${i.e}</span> <span style="color:var(--accent); font-weight:bold;">= ${i.r}</span>`;
         d.onclick=()=>{document.getElementById('display').value=i.r; toggleHistoryPanel();};
         l.appendChild(d);
       });
    }
    function toggleHistoryPanel(){ 
       let p=document.getElementById('historyPanel'); 
       if(p.classList.contains('open')) p.classList.remove('open'); 
       else { renderHistory(); p.classList.add('open'); }
    }
    function clearHistory(){ localStorage.removeItem('ch'); renderHistory(); }

    /* --- CONVERTER --- */
    const cd={length:{s:0,u:{m:1,km:1000,cm:0.01,ft:0.3048}},mass:{s:0,u:{kg:1,g:0.001,lb:0.453}},data:{s:0,u:{mb:1,gb:1024}},temp:{s:1}};
    function populateUnits(){
       let t=document.getElementById('convType').value, f=document.getElementById('convFrom'), to=document.getElementById('convTo');
       f.innerHTML=''; to.innerHTML='';
       let l=cd[t].s?["Celsius","Fahrenheit","Kelvin"]:Object.keys(cd[t].u);
       l.forEach(u=>{f.add(new Option(u,u)); to.add(new Option(u,u));}); if(l.length>1)to.selectedIndex=1; doConvert();
    }
    function doConvert(){
       let t=document.getElementById('convType').value, v=parseFloat(document.getElementById('convInput').value);
       if(isNaN(v)){document.getElementById('convResult').value='';return;}
       let f=document.getElementById('convFrom').value, to=document.getElementById('convTo').value, res;
       if(t==='temp'){
          if(f===to)res=v; else if(f==='Celsius'&&to==='Fahrenheit')res=v*1.8+32; else if(f==='Fahrenheit'&&to==='Celsius')res=(v-32)/1.8; else res=v;
       } else { res=(v*cd[t].u[f])/cd[t].u[to]; }
       document.getElementById('convResult').value=res.toFixed(4);
    }

    /* --- EMI & BILL --- */
    function calculateEMI(){
       let p=document.getElementById('emiP').value, r=document.getElementById('emiR').value/1200, n=document.getElementById('emiN').value*12;
       let e=(p*r*Math.pow(1+r,n))/(Math.pow(1+r,n)-1);
       document.getElementById('emiResult').innerHTML="&#8377; "+(e?e.toFixed(2):"0.00");
    }
    const bd={"India":{c:"&#8377;",r:{"Home":7.5,"Biz":12}},"USA":{c:"$",r:{"Home":0.15,"Biz":0.2}},"UK":{c:"£",r:{"Std":0.34}}};
    function updateBillCats(){
       let r=document.getElementById('billRegion').value, s=document.getElementById('billCat'); s.innerHTML='';
       for(let k in bd[r].r) s.add(new Option(k,k)); updateBillRate();
    }
    function updateBillRate(){ document.getElementById('billRate').value=bd[document.getElementById('billRegion').value].r[document.getElementById('billCat').value]; }
    function calculateBill(){
       let u=document.getElementById('billUnits').value, r=document.getElementById('billRate').value;
       document.getElementById('billTotal').innerHTML="Total: "+bd[document.getElementById('billRegion').value].c+" "+(u*r).toFixed(2);
    }
    
    function openModal(id){document.getElementById('modal-'+id).style.display='flex';}
    function closeModal(id){document.getElementById('modal-'+id).style.display='none';}
    function triggerAds(pid){
       let a=document.querySelector(`#${pid} .ad-wrapper`);
       if(a.style.display!=='flex') setTimeout(()=>a.style.display='flex', 300);
    }
  </script>
</body>
</html>

